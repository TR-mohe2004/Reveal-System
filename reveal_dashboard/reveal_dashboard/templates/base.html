{% load static %}
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}لوحة التحكم{% endblock %} - منظومة ريفيل</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="{% static 'css/main.css' %}">

    <link rel="manifest" href="{% url 'core:manifest' %}">
    <link rel="apple-touch-icon" href="{% static 'icons/icon-192x192.png' %}">
</head>
<body>
    <div class="d-flex" id="wrapper">
        <div id="sidebar-wrapper">
            <div class="sidebar-heading text-center py-4 primary-text fs-4 fw-bold text-uppercase border-bottom">
                <i class="fas fa-rocket me-2"></i>ريفيل
            </div>
            <div class="list-group list-group-flush my-3">
                <a href="{% url 'core:dashboard' %}" class="list-group-item list-group-item-action bg-transparent second-text fw-bold {% if request.resolver_match.url_name == 'dashboard' %}active{% endif %}">
                    <i class="fas fa-tachometer-alt me-2"></i>لوحة التحكم
                </a>
                <a href="{% url 'core:orders' %}" class="list-group-item list-group-item-action bg-transparent second-text fw-bold {% if request.resolver_match.url_name == 'orders' %}active{% endif %}">
                    <i class="fas fa-receipt me-2"></i>الطلبات
                </a>
                <a href="{% url 'core:products' %}" class="list-group-item list-group-item-action bg-transparent second-text fw-bold {% if request.resolver_match.url_name == 'products' %}active{% endif %}">
                    <i class="fas fa-hamburger me-2"></i>المنتجات
                </a>
                <a href="{% url 'core:stock' %}" class="list-group-item list-group-item-action bg-transparent second-text fw-bold {% if request.resolver_match.url_name == 'stock' %}active{% endif %}">
                    <i class="fas fa-boxes me-2"></i>المخزون
                </a>
                <a href="{% url 'core:customers' %}" class="list-group-item list-group-item-action bg-transparent second-text fw-bold {% if request.resolver_match.url_name == 'customers' %}active{% endif %}">
                    <i class="fas fa-users me-2"></i>العملاء
                </a>
                <a href="{% url 'core:wallet_recharge' %}" class="list-group-item list-group-item-action bg-transparent second-text fw-bold {% if request.resolver_match.url_name == 'wallet_recharge' %}active{% endif %}">
                    <i class="fas fa-wallet me-2"></i>المحافظ
                </a>
                <a href="{% url 'core:reports' %}" class="list-group-item list-group-item-action bg-transparent second-text fw-bold {% if request.resolver_match.url_name == 'reports' %}active{% endif %}">
                    <i class="fas fa-chart-line me-2"></i>التقارير
                </a>
                <a href="{% url 'core:settings' %}" class="list-group-item list-group-item-action bg-transparent second-text fw-bold {% if request.resolver_match.url_name == 'settings' %}active{% endif %}">
                    <i class="fas fa-cog me-2"></i>الإعدادات
                </a>
                <a href="{% url 'core:logout' %}" class="list-group-item list-group-item-action bg-transparent text-danger fw-bold">
                    <i class="fas fa-power-off me-2"></i>خروج
                </a>
            </div>
        </div>
        <div id="page-content-wrapper">
            <nav class="navbar navbar-expand-lg navbar-light bg-light py-4 px-4 border-bottom">
                <div class="d-flex align-items-center">
                    <i class="fas fa-align-left primary-text fs-4 me-3" id="menu-toggle" style="cursor: pointer;"></i>
                    <h2 class="fs-2 m-0">{% block header_title %}لوحة التحكم{% endblock %}</h2>
                </div>

                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle second-text fw-bold" href="#" id="navbarDropdown"
                                role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                <i class="fas fa-user me-2"></i>{{ user.full_name|default:"المستخدم" }}
                            </a>
                            <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarDropdown">
                                <li><a class="dropdown-item" href="{% url 'core:settings' %}">الإعدادات</a></li>
                                <li><hr class="dropdown-divider"></li>
                                <li><h6 class="dropdown-header">تبديل المقهى</h6></li>
                                {% for cafe in switchable_cafes %}
                                    <li><a class="dropdown-item" href="{% url 'core:switch_cafe' cafe.id %}">{{ cafe.name }}</a></li>
                                {% empty %}
                                    <li><span class="dropdown-item text-muted">لا توجد مقاهي متاحة</span></li>
                                {% endfor %}
                                <li><hr class="dropdown-divider"></li>
                                <li><a class="dropdown-item" href="{% url 'core:logout' %}">تسجيل خروج</a></li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </nav>

            <div class="container-fluid px-4 py-4">
                {% if messages %}
                    {% for message in messages %}
                        <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
                            {{ message }}
                            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                        </div>
                    {% endfor %}
                {% endif %}

                {% block content %}{% endblock %}
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        var el = document.getElementById("wrapper");
        var toggleButton = document.getElementById("menu-toggle");

        toggleButton.onclick = function () {
            el.classList.toggle("toggled");
        };
    </script>
</body>
</html>
